@page
@model RazorPagesMovie.Pages.Movies.IndexModel
@{
    ViewData["Title"] = "Movies";
}

<div class="d-flex justify-content-center">
    <div class="card shadow-lg p-4 mt-4" style="width: 95%; max-width: 1300px;">

        <!-- PAGE TITLE CENTERED -->
        <h1 class="text-center mb-4 fw-bold text-primary">🎬 Movie List</h1>

        <div class="d-flex gap-4">

            <!-- LEFT-SIDE FILTER PANEL -->
            <div style="width: 260px;">

                <a class="btn btn-primary mb-3 shadow-sm w-100" asp-page="Create">
                    + Create New
                </a>

                <form method="get" class="bg-light p-3 shadow-sm rounded">
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Genre</label>
                        <select asp-for="MovieGenre" asp-items="Model.Genres" class="form-select shadow-sm">
                            <option value="">All</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-semibold">Title</label>
                        <input type="text" asp-for="SearchString" placeholder="Search title..." class="form-control shadow-sm" />
                    </div>

                    <input type="submit" value="Filter" class="btn btn-secondary shadow-sm w-100" />
                </form>
            </div>

            <!-- MOVIE TABLE CENTERED WITH BACKGROUND -->
            <div class="flex-grow-1 d-flex justify-content-center">
                <div class="p-4 rounded shadow-sm" style="width: 90%; background: linear-gradient(to right, #f0f4ff, #e6f0ff);">

                    <!-- MOVIE TITLE CENTERED ON TOP -->
                    <h2 class="text-center fw-bold text-primary mb-4">🎞️ Available Movies</h2>

                    <div class="table-responsive">
                        <table class="table table-hover table-bordered shadow-sm text-center"
                               style="background-color: white; border-radius: 12px; overflow: hidden;">

                            <thead style="background: #143f6b; color:white;">
                                <tr>
                                    <th class="py-3">Title</th>
                                    <th class="py-3">Release Date</th>
                                    <th class="py-3">Genre</th>
                                    <th class="py-3">Price</th>
                                    <th class="py-3">Rating</th>
                                    <th class="py-3">Actions</th>
                                </tr>
                            </thead>

                            <tbody>
                                @foreach (var item in Model.Movie)
                                {
                                    <tr>
                                        <td class="fw-bold">@item.Title</td>
                                        <td>@item.ReleaseDate.ToString("yyyy/MM/dd")</td>
                                        <td><span class="badge bg-primary">@item.Genre</span></td>
                                        <td class="text-success fw-bold">R @item.Price</td>

                                        <!-- STAR RATING -->
                                        <td>
                                            @for (int i = 0; i < item.Rating; i++)
                                            {
                                                <span style="color:gold; font-size:1.3em;">★</span>
                                            }
                                            @for (int i = 0; i < 5 - item.Rating; i++)
                                            {
                                                <span style="color:#d4d4d4; font-size:1.3em;">★</span>
                                            }
                                        </td>

                                        <td>
                                            <a asp-page="./Edit" asp-route-id="@item.Id" class="btn btn-warning btn-sm">Edit</a>
                                            <a asp-page="./Details" asp-route-id="@item.Id" class="btn btn-info btn-sm text-white">Details</a>
                                            <a asp-page="./Delete" asp-route-id="@item.Id" class="btn btn-danger btn-sm">Delete</a>
                                        </td>
                                    </tr>
                                }
                            </tbody>

                        </table>
                    </div>
                </div>
            </div> <!-- <-- Added missing closing tag for the .d-flex.gap-4 div -->
        </div>
    </div>
</div>